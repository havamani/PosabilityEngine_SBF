package com.fss.commons.utils;

import java.nio.charset.StandardCharsets;
import java.security.NoSuchAlgorithmException;

import javax.crypto.Cipher;
import javax.crypto.spec.SecretKeySpec;

import org.apache.commons.codec.binary.Base64;

import com.fss.pos.base.commons.Log;
import com.fss.pos.base.commons.utils.IsoUtil;

public final class CipherUtil {
	
	public static String enCryptString(String value, String key){
		
		try {
			Log.debug("Key for encrypt", key);
			Cipher cipher = Cipher.getInstance("AES/ECB/PKCS5Padding");
			final SecretKeySpec secretKey = new SecretKeySpec(key.getBytes(StandardCharsets.ISO_8859_1), "AES");
			cipher.init(Cipher.ENCRYPT_MODE, secretKey);
			Log.debug("Encrypted Msg Resp", IsoUtil.asciiChar2hex(cipher.doFinal(value.getBytes(StandardCharsets.ISO_8859_1)).toString()));
			final String encryptedString = new String(Base64.encodeBase64(cipher.doFinal(value.getBytes(StandardCharsets.ISO_8859_1))),StandardCharsets.ISO_8859_1);
		//	Log.debug("Encoded after encryption msg Resp", IsoUtil.asciiChar2hex(encryptedString));
			return encryptedString;
		} catch (NoSuchAlgorithmException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return "";
	}
	
	public static String deCryptString(String value, String key){
		
		try {
			
			Cipher cipher = Cipher.getInstance("AES/ECB/NoPadding");
			final SecretKeySpec secretKey = new SecretKeySpec(key.getBytes(StandardCharsets.ISO_8859_1), "AES");
			cipher.init(Cipher.DECRYPT_MODE, secretKey);
			
			
			final String encryptedString = new String(cipher.doFinal(Base64.decodeBase64(value.getBytes(StandardCharsets.ISO_8859_1))),StandardCharsets.ISO_8859_1);
			
			return encryptedString;
		} catch (NoSuchAlgorithmException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return "";
	}
	
	/*		public static void main(String[] args) {
	String val1 = "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";
	String encryptValue = enCryptString("Testing ","5EE9C84372A2B0DA");
	String decrypt = deCryptString(encryptValue,"0123456789ABCDEF");
	//String decrypt1 =deCryptString("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","8959579573471022");

	String val = new String(Base64.decodeBase64(decrypt.getBytes()), StandardCharsets.ISO_8859_1);
	//String t1 = "A95gAAgAAAgQICAAPwI/ABA/AAEAAAEAMDAwMDAwMDAxOQlWAQFTAwEAGAgiEwA1MDAwMDAwMDAxNzMyNTEwTyBOb21hZCBORURCQU5LIFRlc3QgICAgICAgICAgICAgICAgICAgICAgIFBvbW9uUmVzdGF1cmFudHMgICAgICAgICAgICAgIBICABJaQVIAAP8H/w8/AAAAEwAAAwAAAwAHEAcQ4AAAHwEAAABYFE5FRAAAAAAAASNZWTIyMDIzAgBQYgZAMicAAEAyJz8/SU5GSU5JVEUgQyAgICAgICAgICABRhYAAAAAAAABIAIAAAAAAAACAFFlBmJ2PwAAYnY/Pz9NQUVTVFJPICAgICAgICAgICAgIAFGFgAAAAAAAAIQIAIAAAAAAAACAFJhR1RxIAAAVHEgPz9HT0xEIENSRURJICAgICAgICAgIAFHFgAAAAAAAAMQIDACAAAAAAAAAgBQYilBPz8AAEE/Pz8/RVdBTExFVCBCTCAgICAgICAgICABRhYAAAAAAAABIAIAAAAAAAACAFBicEghBQAASCEFPz9WSVNBIERFQklUICAgICAgICAgIAFGFgAAAAAAAAEgAgAAAAAAAAIAUGQBUXk/AABReT8/P1dPUkxEIE1BU1QgICAgICAgICAgAUcWAAAAAAAAATACAAAAAAAAAgBQYz9DJVcAAEMlVz8/TkVEQkFOSyBFTCAgICAgICAgICABRhYAAAAAAAABEAIAAAAAAAACAFBiP0kQUAAASRBQPz9CVVNJTkVTUyBDICAgICAgICAgIAFGFgAAAAAAAAEgAgAAAAAAAAIAUWVIRTFmAABFMWY/P1ZJU0EgQlVTSU4gICAgICAgICAgAUYWAAAAAAAAAhAgAgAAAAAAAAIAUGUBRjYgAABGNiA/P0RFQklUIENBUkQgICAgICAgICAgAUYWAAAAAAAAARACAAAAAAAAAgBQYjFCIhcAAEIiFz8/Q1JFRElUIENBUiAgICAgICAgICABRxYAAAAAAAABMAIAAAAAAAACAFBjckF2eAAAQXZ4Pz9DTyBCUkFOREVEICAgICAgICAgIAFHFgAAAAAAAAEwAgAAAAAAAAIAUGEzUj8YAABSPxg/P01BU1RFUkNBUkQgICAgICAgICAgAUYWAAAAAAAAASACAAAAAAAAAgBRYgJSP3EAAFI/cT8/RUFTWVBBWSBFViAgICAgICAgICABRhYAAAAAAAACECACAAAAAAAAAgBQZDlEUSAAAERRID8/VklTQSBHT0xEICAgICAgICAgICABRhYAAAAAAAABIAIAAAAAAAA=";
	}*/
}	
	
	

